---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.16.1
  name: neo4jrestores.neo4j.neo4j.com
spec:
  group: neo4j.neo4j.com
  names:
    kind: Neo4jRestore
    listKind: Neo4jRestoreList
    plural: neo4jrestores
    singular: neo4jrestore
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - jsonPath: .spec.targetCluster
      name: Target
      type: string
    - jsonPath: .spec.databaseName
      name: Database
      type: string
    - jsonPath: .status.phase
      name: Phase
      type: string
    - jsonPath: .status.stats.duration
      name: Duration
      type: string
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: Neo4jRestore is the Schema for the neo4jrestores API
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: Neo4jRestoreSpec defines the desired state of Neo4jRestore
            properties:
              databaseName:
                description: Database to restore to
                type: string
              force:
                description: Force restore even if database exists
                type: boolean
              options:
                description: Restore options
                properties:
                  additionalArgs:
                    description: Additional neo4j-admin restore arguments
                    items:
                      type: string
                    type: array
                  postRestore:
                    description: Post-restore hooks
                    properties:
                      cypherStatements:
                        description: Cypher statements to execute
                        items:
                          type: string
                        type: array
                      job:
                        description: Job to run as hook
                        properties:
                          template:
                            description: Job template
                            properties:
                              backoffLimit:
                                description: Job-level configuration
                                format: int32
                                type: integer
                              container:
                                description: Container specification
                                properties:
                                  args:
                                    description: Arguments to pass to command
                                    items:
                                      type: string
                                    type: array
                                  command:
                                    description: Command to execute
                                    items:
                                      type: string
                                    type: array
                                  env:
                                    description: Environment variables
                                    items:
                                      description: EnvVar represents an environment
                                        variable
                                      properties:
                                        name:
                                          description: Name of the environment variable
                                          type: string
                                        value:
                                          description: Value of the environment variable
                                          type: string
                                        valueFrom:
                                          description: ValueFrom specifies a source
                                            for the value
                                          properties:
                                            configMapKeyRef:
                                              description: ConfigMap key reference
                                              properties:
                                                key:
                                                  description: Key within the ConfigMap
                                                  type: string
                                                name:
                                                  description: Name of the ConfigMap
                                                  type: string
                                              required:
                                              - key
                                              - name
                                              type: object
                                            secretKeyRef:
                                              description: Secret key reference
                                              properties:
                                                key:
                                                  description: Key within the secret
                                                  type: string
                                                name:
                                                  description: Name of the secret
                                                  type: string
                                              required:
                                              - key
                                              - name
                                              type: object
                                          type: object
                                      required:
                                      - name
                                      type: object
                                    type: array
                                  image:
                                    description: Container image
                                    type: string
                                required:
                                - image
                                type: object
                            required:
                            - container
                            type: object
                          timeout:
                            description: Timeout for the hook job
                            type: string
                        required:
                        - template
                        type: object
                    type: object
                  preRestore:
                    description: Pre-restore hooks
                    properties:
                      cypherStatements:
                        description: Cypher statements to execute
                        items:
                          type: string
                        type: array
                      job:
                        description: Job to run as hook
                        properties:
                          template:
                            description: Job template
                            properties:
                              backoffLimit:
                                description: Job-level configuration
                                format: int32
                                type: integer
                              container:
                                description: Container specification
                                properties:
                                  args:
                                    description: Arguments to pass to command
                                    items:
                                      type: string
                                    type: array
                                  command:
                                    description: Command to execute
                                    items:
                                      type: string
                                    type: array
                                  env:
                                    description: Environment variables
                                    items:
                                      description: EnvVar represents an environment
                                        variable
                                      properties:
                                        name:
                                          description: Name of the environment variable
                                          type: string
                                        value:
                                          description: Value of the environment variable
                                          type: string
                                        valueFrom:
                                          description: ValueFrom specifies a source
                                            for the value
                                          properties:
                                            configMapKeyRef:
                                              description: ConfigMap key reference
                                              properties:
                                                key:
                                                  description: Key within the ConfigMap
                                                  type: string
                                                name:
                                                  description: Name of the ConfigMap
                                                  type: string
                                              required:
                                              - key
                                              - name
                                              type: object
                                            secretKeyRef:
                                              description: Secret key reference
                                              properties:
                                                key:
                                                  description: Key within the secret
                                                  type: string
                                                name:
                                                  description: Name of the secret
                                                  type: string
                                              required:
                                              - key
                                              - name
                                              type: object
                                          type: object
                                      required:
                                      - name
                                      type: object
                                    type: array
                                  image:
                                    description: Container image
                                    type: string
                                required:
                                - image
                                type: object
                            required:
                            - container
                            type: object
                          timeout:
                            description: Timeout for the hook job
                            type: string
                        required:
                        - template
                        type: object
                    type: object
                  replaceExisting:
                    description: Replace existing database
                    type: boolean
                  verifyBackup:
                    description: Verify backup before restore
                    type: boolean
                type: object
              source:
                description: Source backup location
                properties:
                  backupPath:
                    description: Specific backup path within storage
                    type: string
                  backupRef:
                    description: Reference to Neo4jBackup resource (when type=backup)
                    type: string
                  pitr:
                    description: Point-in-time recovery configuration (when type=pitr)
                    properties:
                      baseBackup:
                        description: Base backup to restore from before applying transaction
                          logs
                        properties:
                          backupPath:
                            description: Specific backup path within storage
                            type: string
                          backupRef:
                            description: Reference to Neo4jBackup resource (when type=backup)
                            type: string
                          storage:
                            description: Direct storage location (when type=storage)
                            properties:
                              bucket:
                                type: string
                              cloud:
                                description: Cloud provider configuration
                                properties:
                                  identity:
                                    description: CloudIdentity defines cloud identity
                                      configuration
                                    properties:
                                      autoCreate:
                                        description: AutoCreateSpec defines auto-creation
                                          of service accounts
                                        properties:
                                          annotations:
                                            additionalProperties:
                                              type: string
                                            type: object
                                          enabled:
                                            default: true
                                            type: boolean
                                        type: object
                                      provider:
                                        enum:
                                        - aws
                                        - gcp
                                        - azure
                                        type: string
                                      serviceAccount:
                                        type: string
                                    required:
                                    - provider
                                    type: object
                                  provider:
                                    enum:
                                    - aws
                                    - gcp
                                    - azure
                                    type: string
                                type: object
                              path:
                                type: string
                              pvc:
                                description: PVC configuration
                                properties:
                                  name:
                                    description: Name of the PVC to use (for referencing
                                      existing PVCs)
                                    type: string
                                  size:
                                    type: string
                                  storageClassName:
                                    type: string
                                type: object
                              type:
                                enum:
                                - s3
                                - gcs
                                - azure
                                - pvc
                                type: string
                            required:
                            - type
                            type: object
                          type:
                            description: Type of backup source (backup or storage,
                              PITR not allowed to avoid circular reference)
                            enum:
                            - backup
                            - storage
                            type: string
                        required:
                        - type
                        type: object
                      compression:
                        description: Compression settings for transaction logs
                        properties:
                          algorithm:
                            default: gzip
                            description: Compression algorithm (gzip, lz4, zstd)
                            enum:
                            - gzip
                            - lz4
                            - zstd
                            type: string
                          enabled:
                            default: true
                            description: Enable compression
                            type: boolean
                          level:
                            description: Compression level (1-9 for gzip, 1-12 for
                              lz4, 1-22 for zstd)
                            format: int32
                            type: integer
                        type: object
                      encryption:
                        description: Encryption settings for transaction logs
                        properties:
                          algorithm:
                            default: AES256
                            description: Encryption algorithm (AES256, ChaCha20Poly1305)
                            enum:
                            - AES256
                            - ChaCha20Poly1305
                            type: string
                          enabled:
                            default: false
                            description: Enable encryption
                            type: boolean
                          keySecret:
                            description: Secret containing encryption key
                            type: string
                          keySecretKey:
                            default: key
                            description: Key within the secret
                            type: string
                        type: object
                      logRetention:
                        default: 7d
                        description: Transaction log retention period
                        type: string
                      logStorage:
                        description: Transaction log storage location
                        properties:
                          bucket:
                            type: string
                          cloud:
                            description: Cloud provider configuration
                            properties:
                              identity:
                                description: CloudIdentity defines cloud identity
                                  configuration
                                properties:
                                  autoCreate:
                                    description: AutoCreateSpec defines auto-creation
                                      of service accounts
                                    properties:
                                      annotations:
                                        additionalProperties:
                                          type: string
                                        type: object
                                      enabled:
                                        default: true
                                        type: boolean
                                    type: object
                                  provider:
                                    enum:
                                    - aws
                                    - gcp
                                    - azure
                                    type: string
                                  serviceAccount:
                                    type: string
                                required:
                                - provider
                                type: object
                              provider:
                                enum:
                                - aws
                                - gcp
                                - azure
                                type: string
                            type: object
                          path:
                            type: string
                          pvc:
                            description: PVC configuration
                            properties:
                              name:
                                description: Name of the PVC to use (for referencing
                                  existing PVCs)
                                type: string
                              size:
                                type: string
                              storageClassName:
                                type: string
                            type: object
                          type:
                            enum:
                            - s3
                            - gcs
                            - azure
                            - pvc
                            type: string
                        required:
                        - type
                        type: object
                      recoveryPointObjective:
                        default: 1m
                        description: Recovery point objective
                        type: string
                      validateLogIntegrity:
                        default: true
                        description: Validate transaction log integrity before restore
                        type: boolean
                    type: object
                  pointInTime:
                    description: Point in time for restore (when type=pitr or for
                      PITR with backup/storage types)
                    format: date-time
                    type: string
                  storage:
                    description: Direct storage location (when type=storage)
                    properties:
                      bucket:
                        type: string
                      cloud:
                        description: Cloud provider configuration
                        properties:
                          identity:
                            description: CloudIdentity defines cloud identity configuration
                            properties:
                              autoCreate:
                                description: AutoCreateSpec defines auto-creation
                                  of service accounts
                                properties:
                                  annotations:
                                    additionalProperties:
                                      type: string
                                    type: object
                                  enabled:
                                    default: true
                                    type: boolean
                                type: object
                              provider:
                                enum:
                                - aws
                                - gcp
                                - azure
                                type: string
                              serviceAccount:
                                type: string
                            required:
                            - provider
                            type: object
                          provider:
                            enum:
                            - aws
                            - gcp
                            - azure
                            type: string
                        type: object
                      path:
                        type: string
                      pvc:
                        description: PVC configuration
                        properties:
                          name:
                            description: Name of the PVC to use (for referencing existing
                              PVCs)
                            type: string
                          size:
                            type: string
                          storageClassName:
                            type: string
                        type: object
                      type:
                        enum:
                        - s3
                        - gcs
                        - azure
                        - pvc
                        type: string
                    required:
                    - type
                    type: object
                  type:
                    description: Type of restore source
                    enum:
                    - backup
                    - storage
                    - pitr
                    type: string
                required:
                - type
                type: object
              stopCluster:
                description: Stop cluster before restore (required for some restore
                  operations)
                type: boolean
              targetCluster:
                description: Target cluster to restore to
                type: string
              timeout:
                description: Timeout for restore operation
                type: string
            required:
            - databaseName
            - source
            - targetCluster
            type: object
          status:
            description: Neo4jRestoreStatus defines the observed state of Neo4jRestore
            properties:
              backupInfo:
                description: Backup information that was restored
                properties:
                  backupCreatedAt:
                    description: Original creation time of the backup
                    format: date-time
                    type: string
                  backupPath:
                    description: Source backup path
                    type: string
                  backupSize:
                    description: Backup size
                    type: string
                  neo4jVersion:
                    description: Neo4j version of the backup
                    type: string
                  originalDatabase:
                    description: Original database name in the backup
                    type: string
                type: object
              completionTime:
                description: Completion time of the restore operation
                format: date-time
                type: string
              conditions:
                description: Conditions represent the current state of the restore
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
              message:
                description: Message provides additional information about the current
                  state
                type: string
              observedGeneration:
                description: ObservedGeneration reflects the generation of the most
                  recently observed Neo4jRestore
                format: int64
                type: integer
              phase:
                description: Phase represents the current phase of the restore
                type: string
              startTime:
                description: Start time of the restore operation
                format: date-time
                type: string
              stats:
                description: Restore statistics
                properties:
                  dataSize:
                    description: Size of data restored
                    type: string
                  duration:
                    description: Duration of the restore operation
                    type: string
                  errorCount:
                    description: Errors encountered during restore
                    format: int32
                    type: integer
                  fileCount:
                    description: Number of files restored
                    format: int32
                    type: integer
                  throughput:
                    description: Throughput of the restore operation
                    type: string
                type: object
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
