name: 'Setup Kubernetes Environment'
description: 'Installs Kind, kubectl, and Docker Buildx. Does NOT create a cluster or deploy the operator â€” callers are responsible for that so each workflow controls its own setup without duplication.'

inputs:
  kind-version:
    description: 'Kind version to use'
    required: false
    default: 'v0.20.0'

runs:
  using: 'composite'
  steps:
    - name: Set up Docker Buildx
      uses: docker/setup-buildx-action@v3

    - name: Install Kind
      shell: bash
      run: |
        curl -Lo ./kind https://kind.sigs.k8s.io/dl/${{ inputs.kind-version }}/kind-linux-amd64
        chmod +x ./kind
        sudo mv ./kind /usr/local/bin/kind
        kind version

    - name: Install kubectl
      shell: bash
      run: |
        curl -LO "https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl"
        chmod +x kubectl
        sudo mv kubectl /usr/local/bin/
        kubectl version --client
