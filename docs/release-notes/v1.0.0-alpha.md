# Release Notes ‚Äî v1.0.0-alpha

**Released:** 2026-02-20
**Previous release:** v0.9.4-alpha (2026-01-21)
**Supported Neo4j versions:** 5.26.x (SemVer) ¬∑ 2025.01.0‚Äì2025.12+ (CalVer)
**Kubernetes:** ‚â• 1.21 ¬∑ **cert-manager:** ‚â• 1.18 (for TLS features)

---

## ‚≠ê Highlights

This release graduates the operator to its first `v1.0.0` milestone. It brings five major features across observability, reliability, plugin ecosystem, and developer experience, plus a set of important bug fixes that make the operator production-ready.

| Area | What's new |
|---|---|
| **Aura Fleet Management** | Native integration: operator installs the plugin and registers the Aura token automatically |
| **MCP server** | Optional Model Context Protocol server sidecar for AI-assisted graph operations |
| **Rolling upgrades** | Health checks modernised to `SHOW SERVERS / DATABASES`; config changes trigger restarts |
| **Third-party TLS issuers** | Any cert-manager issuer (AWS PCA, Vault, Google CAS, ‚Ä¶) now accepted |
| **Plugin reliability** | Additive `NEO4J_PLUGINS` merge strategy eliminates controller oscillation |

---

## üÜï New Features

### Aura Fleet Management integration

Monitor self-managed Neo4j deployments from the Neo4j Aura console without any manual plugin installation.

```yaml
spec:
  auraFleetManagement:
    enabled: true
    tokenSecretRef:
      name: aura-fleet-token   # kubectl create secret generic aura-fleet-token --from-literal=token='<token>'
      key: token
```

**How it works**

1. The operator merges `"fleet-management"` into `NEO4J_PLUGINS` on the StatefulSet using an *additive* strategy ‚Äî existing plugins from `Neo4jPlugin` CRDs are preserved.
2. The Neo4j Docker entrypoint copies the pre-bundled jar from `/var/lib/neo4j/products/` to `/plugins/` on pod startup ‚Äî **no internet access required**.
3. Procedure security settings (`dbms.security.procedures.unrestricted=fleetManagement.*`) are applied to `neo4j.conf` automatically.
4. Once the cluster reaches `Ready` phase, the operator reads the Aura token from the referenced Kubernetes Secret and calls `CALL fleetManagement.registerToken($token)` via Bolt. This is idempotent.

Works identically on `Neo4jEnterpriseCluster` and `Neo4jEnterpriseStandalone`.

See [Aura Fleet Management Guide](../user_guide/aura_fleet_management.md) and [examples/fleet-management/](../../examples/fleet-management/).

---

### MCP server sidecar

Deploy an optional [Model Context Protocol](https://spec.modelcontextprotocol.io/) server alongside your Neo4j cluster or standalone instance. MCP exposes graph operations (Cypher queries, schema inspection) to AI tooling such as Claude and GitHub Copilot via the MCP protocol over HTTP or STDIO.

The operator uses the **official `mcp/neo4j` image** from Docker Hub ([hub.docker.com/r/mcp/neo4j](https://hub.docker.com/r/mcp/neo4j)), the supported Neo4j product MCP server. No custom image build is required.

```yaml
spec:
  mcp:
    enabled: true
    # image defaults to mcp/neo4j:latest ‚Äî no need to specify
```

> **Note (post-release update)**: The initial release shipped with the Labs `mcp/neo4j-cypher` image. The operator was subsequently updated to use the official `mcp/neo4j` image (`github.com/neo4j/mcp`), which has a different authentication model (per-request Basic Auth / Bearer token in HTTP mode) and different env vars. See the [MCP Client Setup Guide](../user_guide/guides/mcp_client_setup.md) for current configuration.

A dedicated integration test (`mcp_integration_test.go`) validates the HTTP endpoint end-to-end in CI. See [MCP Client Setup Guide](../user_guide/guides/mcp_client_setup.md).

---

### Third-party cert-manager issuer support (issue #26)

TLS configuration now accepts *any* registered cert-manager issuer ‚Äî not just the built-in `Issuer` and `ClusterIssuer` kinds. The `IssuerRef.Kind` enum restriction has been removed from the CRD schema and the Go validator.

```yaml
spec:
  tls:
    mode: cert-manager
    issuerRef:
      name: aws-pca-cluster-issuer    # AWS Private CA
      kind: AWSPCAClusterIssuer
      group: awspca.cert-manager.io
```

External issuers such as AWS PCA (`AWSPCAClusterIssuer`), HashiCorp Vault (`VaultIssuer`), and Google CAS (`GoogleCASIssuer`) are all accepted. The `IssuerRef.Group` field, which was previously silently dropped in the standalone controller, is now passed through to the cert-manager `Certificate` resource.

---

### Namespace pattern watching

The operator can now watch Neo4j resources across multiple namespaces using wildcard or comma-separated patterns, rather than being limited to a single namespace or all namespaces.

---

### Operator telemetry via `NEO4J_UDC_PACKAGING`

Every Neo4j Enterprise container managed by the operator now receives a `NEO4J_UDC_PACKAGING=k8s-<version>` environment variable. This allows Neo4j's Usage Data Collector to accurately attribute metrics to Kubernetes operator deployments. Defaults to `k8s-development` when the operator is built without a version tag.

---

## üêõ Bug Fixes

### `spec.auth.adminSecret` was silently ignored in cluster server pods (issue #27)

`buildStatefulSetForEnterprise` hardcoded the default admin secret name instead of reading `cluster.Spec.Auth.AdminSecret`. This caused pods to reference the wrong Kubernetes Secret when a custom `adminSecret` was configured, resulting in `secret not found` errors and failed pod startup. The backup StatefulSet builder already had the correct pattern; the server StatefulSet now uses the same guard.

**Impact:** Any `Neo4jEnterpriseCluster` using a non-default `spec.auth.adminSecret` name was affected. Upgrading to v1.0.0-alpha resolves the issue without any manifest changes.

---

### `spec.config` changes did not trigger a rolling restart

Modifications to `spec.config` (custom `neo4j.conf` settings) were applied to the ConfigMap but did not cause pods to restart and pick up the new configuration. The reconciler now correctly detects ConfigMap hash changes and triggers a rolling restart.

---

### Rolling upgrade health checks used deprecated APIs

The rolling upgrade orchestrator used `CALL dbms.cluster.role()` and similar deprecated procedures to assess node health. These were replaced with `SHOW SERVERS` and `SHOW DATABASES`, which are the supported APIs in Neo4j 5.26+ and all 2025.x releases.

---

### `IssuerRef.Group` dropped in standalone TLS certificates

When configuring TLS for `Neo4jEnterpriseStandalone` with a third-party issuer, the `IssuerRef.Group` field was silently dropped when constructing the cert-manager `Certificate` resource, causing certificate requests to fail with external issuers. Now correctly forwarded.

---

### `NEO4J_PLUGINS` oscillation between cluster controller and plugin controller

When a `Neo4jPlugin` CRD was applied to a cluster that had Fleet Management enabled (or any future operator-managed plugin), the two controllers would oscillate: the plugin controller live-patched `NEO4J_PLUGINS` to add its plugin, and on the next reconcile the cluster controller regenerated its desired template (which didn't include the plugin controller's addition) and detected a mismatch, overwriting the StatefulSet.

**Fix:** `envVarsEqual` in the cluster/standalone controller now uses *subset* semantics ‚Äî it verifies that all *desired* env vars are present with correct values, but tolerates extra env vars added by other controllers. `NEO4J_PLUGINS` additions from both the plugin controller and the fleet management reconciler use the shared `MergeNeo4jPluginList` utility, which is idempotent and additive.

---

## üîß Improvements

### Property sharding version corrected (2025.10 ‚Üí 2025.12)

Property sharding (Infinigraph) requires Neo4j **2025.12+**, not 2025.10 as previously documented and enforced. All version checks, error messages, tests, and documentation have been updated. The feature guard function has been renamed from `IsNeo4jVersion202510OrHigher` to `IsNeo4jVersion202512OrHigher`.

### Release workflow hardened

- Go version standardised to **1.24** across all workflows.
- A `determine-tag` job now computes the release tag once and shares it across all downstream jobs, eliminating three-way duplication of tag-parsing logic.
- CRDs generated in `validate-release` are uploaded as artifacts and downloaded in `create-release` for byte-for-byte reproducibility.
- The operator image is now signed with **Cosign keyless OIDC** signing on every release. (The MCP server image is the official `mcp/neo4j` published by Neo4j ‚Äî the operator no longer builds or pushes a custom MCP image.)
- Helm chart published to GHCR OCI registry on release.
- `source.tar.gz` in workflow-dispatch releases correctly falls back to `HEAD` when the tag is not yet in git history.

### Developer experience

- `config/overlays/dev/kustomization.yaml`: fixed image override that targeted the placeholder name `controller` instead of the resolved `ghcr.io/neo4j-partners/neo4j-kubernetes-operator` name, causing `ErrImagePull` when deploying to a local Kind cluster.
- CI integration tests no longer run with `GOMAXPROCS=1`, restoring realistic concurrency.
- Neo4j image loading in CI uses `skopeo` to copy a single-platform `linux/amd64` image into Kind, avoiding `--all-platforms` errors in the `ctr` import path.

---

## üìã API Changes

### New fields

| CRD | Field | Type | Description |
|---|---|---|---|
| `Neo4jEnterpriseCluster` | `spec.auraFleetManagement` | `AuraFleetManagementSpec` | Aura Fleet Management integration |
| `Neo4jEnterpriseCluster` | `status.auraFleetManagement` | `AuraFleetManagementStatus` | Registration status (read-only) |
| `Neo4jEnterpriseStandalone` | `spec.auraFleetManagement` | `AuraFleetManagementSpec` | Aura Fleet Management integration |
| `Neo4jEnterpriseStandalone` | `status.auraFleetManagement` | `AuraFleetManagementStatus` | Registration status (read-only) |
| `Neo4jEnterpriseCluster` | `spec.mcp` | `MCPServerSpec` | MCP sidecar configuration |
| `Neo4jEnterpriseStandalone` | `spec.mcp` | `MCPServerSpec` | MCP sidecar configuration |

### Relaxed constraints

| CRD | Field | Change |
|---|---|---|
| `Neo4jEnterpriseCluster` / `Neo4jEnterpriseStandalone` | `spec.tls.issuerRef.kind` | Enum restriction `Issuer\|ClusterIssuer` removed; any cert-manager issuer kind accepted |
| `Neo4jEnterpriseCluster` / `Neo4jEnterpriseStandalone` | `spec.tls.issuerRef.group` | Now correctly forwarded to cert-manager `Certificate` resource |

### No breaking changes

All existing `Neo4jEnterpriseCluster`, `Neo4jEnterpriseStandalone`, `Neo4jDatabase`, `Neo4jPlugin`, `Neo4jBackup`, and `Neo4jRestore` resources from v0.9.x are fully compatible with v1.0.0-alpha without any manifest changes.

---

## üì¶ Upgrade Guide

### From v0.9.x

1. Update the operator image tag in your deployment:
   ```bash
   # Helm
   helm upgrade neo4j-operator oci://ghcr.io/neo4j-partners/neo4j-kubernetes-operator \
     --version 1.0.0-alpha

   # kubectl (kustomize)
   cd config/overlays/prod
   kustomize edit set image ghcr.io/neo4j-partners/neo4j-kubernetes-operator=ghcr.io/neo4j-partners/neo4j-kubernetes-operator:v1.0.0-alpha
   kubectl apply -k .
   ```

2. Update CRDs (required for Aura Fleet Management and third-party TLS issuer fields):
   ```bash
   kubectl apply -f https://github.com/neo4j-partners/neo4j-kubernetes-operator/releases/download/v1.0.0-alpha/crds.yaml
   ```

3. **If you were using a custom `spec.auth.adminSecret`:** verify your cluster pods restart cleanly after the upgrade. The bug fix (#27) means pods will now correctly reference your custom secret.

4. No other configuration changes are required.

---

## üîó Resources

- [Documentation](https://github.com/neo4j-partners/neo4j-kubernetes-operator/tree/v1.0.0-alpha/docs)
- [Aura Fleet Management Guide](https://github.com/neo4j-partners/neo4j-kubernetes-operator/blob/v1.0.0-alpha/docs/user_guide/aura_fleet_management.md)
- [MCP Client Setup](https://github.com/neo4j-partners/neo4j-kubernetes-operator/blob/v1.0.0-alpha/docs/user_guide/guides/mcp_client_setup.md)
- [Examples](https://github.com/neo4j-partners/neo4j-kubernetes-operator/tree/v1.0.0-alpha/examples)
- [Changelog (since v0.9.4-alpha)](https://github.com/neo4j-partners/neo4j-kubernetes-operator/compare/v0.9.4-alpha...v1.0.0-alpha)
